<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QR & Barcode Generator</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      max-width:700px; 
      margin:40px auto; 
      background-color: #6F4E37; /* brown background */
      color: white; /* text color for contrast */
      padding: 20px;
      border-radius: 12px;
    }

    h1 {
      text-align: center;
    }

    label { 
      display:block; 
      margin-top:10px;
      font-weight: bold;
    }

    textarea, select {
      width:100%; 
      height:80px;
      border-radius: 6px;
      border: none;
      padding: 8px;
      margin-top: 5px;
    }

    select {
      height: 35px;
    }

    img { 
      margin-top:20px; 
      max-width:100%;
      border: 2px solid white;
      border-radius: 8px;
    }

    button { 
      margin-top:10px;
      background-color: #D2B48C; /* light brown */
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }

    button:hover {
      background-color: #C19A6B;
    }

    a {
      color: #FFD700;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>QR & Barcode Generator</h1>
  <label>Type
    <select id="type">
      <option value="qrcode">QR Code</option>
      <option value="barcode">Barcode (Code128)</option>
    </select>
  </label>

  <label>Text / URL
    <textarea id="text" placeholder="Enter text or URL here"></textarea>
  </label>

  <button id="generate">Generate</button>
  <div>
    <a id="downloadLink" style="display:none" download>Download image</a>
    <br>
    <img id="preview" alt="preview will appear here"/>
  </div>

  <script>
    const btn = document.getElementById('generate')
    const preview = document.getElementById('preview')
    const dl = document.getElementById('downloadLink')

    btn.addEventListener('click', async () => {
      const type = document.getElementById('type').value
      const text = document.getElementById('text').value
      try {
        const res = await fetch('/generate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ type, text })
        })
        if (!res.ok) {
          const err = await res.json()
          alert('Error: ' + (err.error || res.status))
          return
        }
        const blob = await res.blob()
        const url = URL.createObjectURL(blob)
        preview.src = url
        dl.href = url
        dl.style.display = 'inline-block'
        dl.textContent = 'Download ' + type + ' image'
      } catch (e) {
        alert('Request failed: ' + e.message)
      }
    })
  </script>
</body>
</html>
